import SEO, { scopes } from '../../components/SEO';

<SEO
  title="Modal"
  scope={scopes.components}
  description="A dialog is a window overlaid on either the primary window or another dialog window."
/>

# Modal (Dialog)

A dialog is a window overlaid on either the primary window or another dialog
window. Contents behind a modal dialog are **inert** meaning that users cannot
interact with content behind the dialog.

## Import

```js
import { Modal, ModalHeader, ModalFooter, ModalBody, ModalTitle, ModalClosebutton } from '@sajari/react-components';
```

## Usage

When the modal opens, focus is sent into the modal and set to the first tabbable
element. If there are no tabbled element, focus is set on the `ModalContent`.

```jsx
function BasicUsage() {
  const [open, setOpen] = React.useState(false);

  const onOpen = () => setOpen(true);
  const onClose = () => setOpen(false);

  return (
    <>
      <Button onClick={onOpen}>Open Modal</Button>

      <Modal open={open} onClose={onClose}>
        <ModalHeader>
          <ModalTitle>Modal title</ModalTitle>
          <ModalCloseButton />
        </ModalHeader>

        <ModalBody>
          <Text>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pulvinar risus non risus hendrerit
            venenatis. Pellentesque sit amet hendrerit risus, sed porttitor quam.
          </Text>
        </ModalBody>
        <ModalFooter>
          <Button appearance="primary">Action</Button>
          <Button onClick={onClose}>Close</Button>
        </ModalFooter>
      </Modal>
    </>
  );
}
```

### Close Modal on Overlay Click

By default, the modal closes when you click it's overlay. You can set
`closeOnOverlayClick` to `false` if you want the modal to stay visible.

```jsx
function ManualClose() {
  const [open, setOpen] = React.useState(false);

  const onOpen = () => setOpen(true);
  const onClose = () => setOpen(false);

  return (
    <>
      <Button onClick={onOpen}>Open Modal</Button>

      <Modal closeOnOverlayClick={false} open={open} onClose={onClose}>
        <ModalHeader>
          <ModalTitle>Modal Title</ModalTitle>
          <ModalCloseButton />
        </ModalHeader>

        <ModalBody pb={6}>
          <Text>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pulvinar risus non risus hendrerit
            venenatis. Pellentesque sit amet hendrerit risus, sed porttitor quam.
          </Text>
        </ModalBody>

        <ModalFooter>
          <Button appearance="primary">Save</Button>
          <Button onClick={onClose}>Close</Button>
        </ModalFooter>
      </Modal>
    </>
  );
}
```

### Block Scrolling when Modal opens

For accessibility, it's recommended to block scrolling on the main document
behind the modal. Sajari does this by default but you can set
`blockScroll` to `false` to allow scrolling behind modal.

```jsx
function BasicUsage() {
  const [open, setOpen] = React.useState(false);

  const onOpen = () => setOpen(true);
  const onClose = () => setOpen(false);

  return (
    <>
      <Button onClick={onOpen}>Open Modal</Button>

      <Modal blockScroll={false} open={open} onClose={onClose}>
        <ModalHeader>
          <ModalTitle>Modal Title</ModalTitle>
          <ModalCloseButton />
        </ModalHeader>

        <ModalBody>
          <Text fontWeight="bold" mb="1rem">
            You can scroll the content behind the modal
          </Text>
        </ModalBody>

        <ModalFooter>
          <Button appearance="primary">Action</Button>
          <Button onClick={onClose}>Close</Button>
        </ModalFooter>
      </Modal>
    </>
  );
}
```

### Center Modal Content

By default, the modal content is centered on screens. You can set
`center` to `false` if you want to keep the dialog on top of the page.

```jsx
function Center() {
  const [open, setOpen] = React.useState(false);

  const onOpen = () => setOpen(true);
  const onClose = () => setOpen(false);

  return (
    <>
      <Button onClick={onOpen}>Open Modal</Button>

      <Modal open={open} onClose={onClose} center={false}>
        <ModalHeader>
          <ModalTitle>Modal Title</ModalTitle>
          <ModalCloseButton />
        </ModalHeader>

        <ModalBody>
          <Text>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pulvinar risus non risus hendrerit
            venenatis. Pellentesque sit amet hendrerit risus, sed porttitor quam.
          </Text>
        </ModalBody>

        <ModalFooter>
          <Button appearance="primary">Action</Button>
          <Button onClick={onClose}>Close</Button>
        </ModalFooter>
      </Modal>
    </>
  );
}
```

### Modal Sizes

Pass the `size` prop if you need to adjust the size of the modal. Values can be any of the following:

| Value              | Max Width |
| ------------------ | --------- |
| `max-w-xs`         | `20rem`   |
| `max-w-sm`         | `24rem`   |
| `max-w-md`         | `28rem`   |
| `max-w-lg`         | `32rem`   |
| `max-w-xl`         | `36rem`   |
| `max-w-2xl`        | `42rem`   |
| `max-w-3xl`        | `48rem`   |
| `max-w-4xl`        | `56rem`   |
| `max-w-5xl`        | `64rem`   |
| `max-w-6xl`        | `72rem`   |
| `max-w-7xl`        | `80rem`   |
| `max-w-screen-sm`  | `640px`   |
| `max-w-screen-md`  | `768px`   |
| `max-w-screen-lg`  | `1024px`  |
| `max-w-screen-xl`  | `1280px`  |
| `max-w-screen-2xl` | `1536px`  |
| `max-w-full`       | `100%`    |

```jsx
function SizeExample() {
  const [open, setOpen] = React.useState(false);

  const onOpen = () => setOpen(true);
  const onClose = () => setOpen(false);

  const [size, setSize] = React.useState('md');
  const sizes = [
    'xs',
    'sm',
    'md',
    'lg',
    'xl',
    '2xl',
    '3xl',
    '4xl',
    '5xl',
    '6xl',
    '7xl',
    'screen-sm',
    'screen-md',
    'screen-lg',
    'screen-xl',
    'screen-2xl',
    'full',
  ];

  return (
    <>
      <Box className="flex space-x-2">
        <Select value={size} onChange={setSize} label="Size">
          {sizes.map((size) => (
            <Option value={size} key={size}>
              {size}
            </Option>
          ))}
        </Select>
        <Button onClick={onOpen}>Open</Button>
      </Box>

      <Modal onClose={onClose} size={size} open={open}>
        <ModalHeader>
          <ModalTitle>Modal Title</ModalTitle>
          <ModalCloseButton />
        </ModalHeader>

        <ModalBody>
          <Text>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pulvinar risus non risus hendrerit
            venenatis. Pellentesque sit amet hendrerit risus, sed porttitor quam.
          </Text>
        </ModalBody>

        <ModalFooter>
          <Button onClick={onClose}>Close</Button>
        </ModalFooter>
      </Modal>
    </>
  );
}
```

### Making other elements Inert

When the modal is open, it's rendered within a portal and all it's siblings have
`aria-hidden` set to `true` so the only thing screen readers see is the modal.
To disable this behavior, set `useInert` to `false`.

## Accessibility

### Keyboard and Focus Management

- When the modal opens, focus is trapped within it.
- Clicking on the overlay closes the Modal.
- Pressing <kbd>Esc</kbd> closes the Modal.
- Scrolling is blocked on the elements behind the modal.
- The modal is portalled to the end of `document.body` to break it out of the
  source order and make it easy to add `aria-hidden` to its siblings.

### ARIA

- The `ModalContent` has `aria-modal` set to `true`.
- The `ModalContent` has `aria-labelledby` set to the `id` of the `ModalTitle`
- The `ModalContent` has `aria-describedby` set to the `id` of the `ModalBody`

## Props

### Modal Props

| Name                | Type              | Default      | Description                                                                                                                             |
| ------------------- | ----------------- | ------------ | --------------------------------------------------------------------------------------------------------------------------------------- |
| open                | `boolean`         |              | If `true`, the modal will open                                                                                                          |
| onClose             | `(event) => void` |              | Callback invoked to close the modal.                                                                                                    |
| useInert            | `boolean`         | `true`       | A11y: If `true`, all elements behing the `Modal` will have `aria-hidden` set to `true` so that screen readers can only see the `Modal`. |
| id                  | `string`          |              | The `id` of the modal.                                                                                                                  |
| ariaLabelledby      | `string`          |              | ARIA label for the modal.                                                                                                               |
| ariaDescribedby     | `string`          |              | ARIA description for the modal.                                                                                                         |
| fullWidth           | `boolean`         | `false`      | If `true`, the width of the content will be full screen.                                                                                |
| fullHeight          | `boolean`         | `false`      | If `true`, the height of the content will be full screen.                                                                               |
| closeOnEsc          | `boolean`         | `true`       | Is the modal closable when user press esc key.                                                                                          |
| closeOnOverlayClick | `boolean`         | `true`       | Is the modal closable when user click on overlay.                                                                                       |
| blockScroll         | `boolean`         | `true`       | Whether to block scrolling when dialog is open.                                                                                         |
| center              | `boolean`         | `true`       | Should the modal content be centered.                                                                                                   |
| trapFocus           | `boolean`         | `true`       | When the modal is open, trap focus within it.                                                                                           |
| initialFocusRef     | `React.Ref`       |              | The `ref` of the element to receive focus when the dialog opens                                                                         |
| finalFocusRef       | `React.Ref`       |              | The `ref` of element to receive focus when the dialog closes                                                                            |
| returnFocusOnClose  | `boolean`         | `true`       | If `true`, the modal will return focus to the element that triggered it when it closes.                                                 |
| container           | `Element`         |              | The container where the portal will be rendered inside.                                                                                 |
| size                | `string`          | `md`         | The width for the modal content.                                                                                                        |
| modalId             | `string`          |              | `id` attribute for modal.                                                                                                               |
| onEscKeyDown        | `(event) => void` |              | Callback fired when the escape key is pressed.                                                                                          |
| onOverlayClick      | `(event) => void` |              | Callback fired when the overlay is clicked.                                                                                             |
| onAnimationEnd      | `() => void`      |              | Callback fired when the Modal has exited and the animation is finished.                                                                 |
| zIndex              | `2147483647`      | `2147483647` | z-index of the modal.                                                                                                                   |
